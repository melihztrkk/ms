// ekstra sabit yapılandırma

# Tanımlar  DO_USE_LEDS  1

// özellik sabit yapılandırması

# ifndef DO_USE_SERIAL
# define  DO_USE_SERIAL  0
# endif  / * tarih DO_USE_SERIAL * /

# ifndef DO_USE_LEDS
# define  DO_USE_LEDS  0
# endif  / * ndef DO_USE_LEDS * /

# define  MOTOR_PWM_MAX  150
# define  MOTOR_PWM_MID  100
# define  MOTOR_PWM_MIN  50

// pin sabit yapılandırması

# Eğer DO_USE_LEDS
# define  PIN_LED_A  16
# define  PIN_LED_B  15
# define  PIN_LED_C  17
# endif  / * DO_USE_LEDS * /

# define  PIN_BTN_1  11
# define  PIN_BTN_2 A1

# define  PIN_PROXIMITY_LEFT A8
# define  PIN_PROXIMITY_BACK A6
# define  PIN_PROXIMITY_RIGHT A4

# define  PIN_SHARP_LEFT  7
# define  PIN_SHARP_CENTER A3
# define  PIN_SHARP_RIGHT A5

# define  PIN_MOTOR_LEFT_A  5
# define  PIN_MOTOR_LEFT_B  6
# define  PIN_MOTOR_RIGHT_A  10
# define  PIN_MOTOR_RIGHT_B  9

// çalışma zamanı yapılandırması

boolean doRun = yanlış ;
boolean didWaitFiveSeconds = yanlış ;

void  setup () {
# Eğer DO_USE_SERIAL
  // Serial'i kurun
  Seri. başlar ( 9600 );
  süre (! Seri);
  Seri. println ( " merhaba dünya. " );
# endif  / * DO_USE_SERIAL * /

# Eğer DO_USE_LEDS
  // LED'leri ayarla
  pinMode (PIN_LED_A, ÇIKIŞ);
  pinMode (PIN_LED_B, ÇIKIŞ);
  pinMode (PIN_LED_C, ÇIKIŞ);
# endif  / * DO_USE_LEDS * /

  // düğmeleri ayarla
  pinMode (PIN_BTN_1, INPUT_PULLUP);
  pinMode (PIN_BTN_2, INPUT_PULLUP);

  // zemin sensörlerini ayarlama
  pinMode (PIN_PROXIMITY_LEFT, GİRİŞ);
  pinMode (PIN_PROXIMITY_BACK, GİRİŞ);
  pinMode (PIN_PROXIMITY_RIGHT, GİRİŞ);

  // düşman sensörleri kurun
  pinMode (PIN_SHARP_LEFT, GİRİŞ);
  pinMode (PIN_SHARP_CENTER, GİRİŞ);
  pinMode (PIN_SHARP_RIGHT, GİRİŞ);

  // motorları kur
  pinMode (PIN_MOTOR_LEFT_A, ÇIKIŞ);
  pinMode (PIN_MOTOR_LEFT_B, ÇIKIŞ);
  pinMode (PIN_MOTOR_RIGHT_A, ÇIKIŞ);
  pinMode (PIN_MOTOR_RIGHT_B, ÇIKIŞ);
}

void  loop () {
  if (! doRun) if (! digitalRead (PIN_BTN_1)) doRun = true ; // doRun yanlıştı ve btn 1 itildi
  if (doRun) if (! digitalRead (PIN_BTN_2)) doRun = yanlış ; // doRun doğruydu ve btn 2 itildi

  if (! doRun) {
    // iptal etmek; ya öldürme düğmesine basıldı ya da henüz başlatılmadık

# Eğer DO_USE_LEDS
    digitalWrite (PIN_LED_A, DÜŞÜK);
    digitalWrite (PIN_LED_B, DÜŞÜK);
    digitalWrite (PIN_LED_C, LOW);
# endif  / * DO_USE_LEDS * /

    goForward ( 0 , 0 );

    didWaitFiveSeconds = yanlış ;
    dönüş ;
  }

  if (! didWaitFiveSeconds) {
    gecikme ( 5000 );
    didWaitFiveSeconds = true ;
  }

  int motorState = 0 ;

  if (! digitalRead (PIN_SHARP_LEFT)) {
    motorState + = 8 ;
  }
  eğer (! digitalRead (PIN_SHARP_CENTER)) {
    motorState + = 16 ;
  }
  eğer (! digitalRead (PIN_SHARP_RIGHT)) {
    motorState + = 32 ;
  }

  if (motorState == 0 ) {
    eğer ( analogOkuma (PIN_PROXIMITY_LEFT) < 150 ) {
      motorState + = 1 ;
# Eğer DO_USE_LEDS
      digitalWrite (PIN_LED_A, YÜKSEK);
# endif  / * DO_USE_LEDS * /
    }
    başka {
# Eğer DO_USE_LEDS
      digitalWrite (PIN_LED_A, DÜŞÜK);
# endif  / * DO_USE_LEDS * /
    }

    eğer ( analogOkuma (PIN_PROXIMITY_RIGHT) < 150 ) {
      motorState + = 2 ;
# Eğer DO_USE_LEDS
      digitalWrite (PIN_LED_B, YÜKSEK);
# endif  / * DO_USE_LEDS * /
    }
    başka {
# Eğer DO_USE_LEDS
      digitalWrite (PIN_LED_B, DÜŞÜK);
# endif  / * DO_USE_LEDS * /
    }

    eğer ( analogOkuma (PIN_PROXIMITY_BACK) < 150 ) {
      motorState + = 4 ;
# Eğer DO_USE_LEDS
      digitalWrite (PIN_LED_C, YÜKSEK);
# endif  / * DO_USE_LEDS * /
    }
    başka {
# Eğer DO_USE_LEDS
      digitalWrite (PIN_LED_C, LOW);
# endif  / * DO_USE_LEDS * /
    }
  }

  anahtar (motorState) {
  case  0 : // hiçbir yerde
    goRight (MOTOR_PWM_MIN, MOTOR_PWM_MIN);
    gecikme ( 10 );
    kırmak ;
  durum  1 :
    goRight (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 300 );
    kırmak ;
  durum  2 :
    goLeft (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 300 );
    kırmak ;
  durum  3 :
    goBackwards (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 200 );
    kırmak ;
  durum  4 :
    goForward (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 300 );
    kırmak ;
  durum  5 :
    goForward (MOTOR_PWM_MAX, MOTOR_PWM_MAX);
    gecikme ( 200 );
    goRight (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 100 );
    kırmak ;
  durum  6 :
    goForward (MOTOR_PWM_MAX, MOTOR_PWM_MAX);
    gecikme ( 200 );
    goLeft (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 100 );
    kırmak ;
  durum  7 :
    goForward ( 0 , 0 );
    gecikme ( 10 );
    kırmak ;
  durum  8 : // keskin sola
    goLeft (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 10 );
    kırmak ;
  vaka  16 : // keskin merkez
    goForward (MOTOR_PWM_MAX, MOTOR_PWM_MAX);
    gecikme ( 10 );
    kırmak ;
  vaka  24 : // keskin sol + orta
    goForward (MOTOR_PWM_MID, MOTOR_PWM_MAX);
    gecikme ( 10 );
    kırmak ;
  vaka  32 : // keskin sağ
    goRight (MOTOR_PWM_MID, MOTOR_PWM_MID);
    gecikme ( 10 );
    kırmak ;
  case  48 : // keskin merkez + sağ
    goForward (MOTOR_PWM_MAX, MOTOR_PWM_MID);
    gecikme ( 10 );
    kırmak ;
  vaka  40 : // keskin sol + sağ
  vaka  56 : // keskin sol + orta + sağ
    goForward (MOTOR_PWM_MAX, MOTOR_PWM_MAX);
    gecikme ( 10 );
    kırmak ;
  }
}

void  goForward ( int leftSpeed, int rightSpeed) {
  analogWrite (PIN_MOTOR_LEFT_A, leftSpeed);
  digitalWrite (PIN_MOTOR_LEFT_B, DÜŞÜK);
  analogWrite (PIN_MOTOR_RIGHT_A, rightSpeed);
  digitalWrite (PIN_MOTOR_RIGHT_B, DÜŞÜK);
}

void  goBackwards ( int leftSpeed, int rightSpeed) {
  analogWrite (PIN_MOTOR_LEFT_B, leftSpeed);
  digitalWrite (PIN_MOTOR_LEFT_A, DÜŞÜK);
  analogWrite (PIN_MOTOR_RIGHT_B, rightSpeed);
  digitalWrite (PIN_MOTOR_RIGHT_A, DÜŞÜK);
}

void  goLeft ( int leftSpeed, int rightSpeed) {
  analogWrite (PIN_MOTOR_LEFT_B, leftSpeed);
  digitalWrite (PIN_MOTOR_LEFT_A, DÜŞÜK);
  analogWrite (PIN_MOTOR_RIGHT_A, rightSpeed);
  digitalWrite (PIN_MOTOR_RIGHT_B, DÜŞÜK);
}

void  goRight ( int leftSpeed, int rightSpeed) {
  analogWrite (PIN_MOTOR_LEFT_A, leftSpeed);
  digitalWrite (PIN_MOTOR_LEFT_B, DÜŞÜK);
  analogWrite (PIN_MOTOR_RIGHT_B, rightSpeed);
  digitalWrite (PIN_MOTOR_RIGHT_A, DÜŞÜK);
}
